<!DOCTYPE html>
<html lang="en">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<title>TableMagnet</title>

<meta name="description"
    content="I do cyber security stuff, including reverse engineering and pen testing.">
<meta name="author" content="">
<link rel="canonical" href="https://tablemagnet.com/" />

<link href="https://tablemagnet.com/css/stylesheet.min.1e18c08e410fc9eafbe1bfba4455a75ae4e6715c5333f7aa74ca9b9e2e40395d.css" integrity="sha256-HhjAjkEPyer74b&#43;6RFWnWuTmcVxTM/eqdMqbni5AOV0=" rel="preload stylesheet"
    as="style">

<link rel="apple-touch-icon" href="https://tablemagnet.com/apple-touch-icon.png">
<link rel="icon" href="https://tablemagnet.com/favicon.ico">
<meta name="generator" content="Hugo 0.68.3" />
<link rel="alternate" type="application/rss+xml" href="https://tablemagnet.com/index.xml" title="TableMagnet" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:site" content="@TableMagnet"/>
<meta name="twitter:author" content="@TableMagnet"/>
<meta name="twitter:title" content="TableMagnet"/>
<meta name="twitter:description" content="I do cyber security stuff, including reverse engineering and pen testing."/>
<meta name="twitter:image" content="https://tablemagnet.com/icon.png"/>
<meta name="twitter:image:alt" content="TableMagnet logo"/>

</head>

<body class="list home" id="top">
<header class="header">
    <nav class="nav">
        <h1 class="logo"><a href="https://tablemagnet.com/">TableMagnet</a></h1>
        <ul class="menu" id="menu" onscroll="menu_on_scroll()">
        </ul>
    </nav>
</header>
    <main class="main"> 


<article class="first-entry">
    <header class="entry-header">
        <h2>Hi there üëã</h2>
    </header>
    <section class="entry-content">
        <p>I do cyber security stuff, including reverse engineering and pen testing.</p>
    </section>
    <footer class="entry-footer"><div class="social-icons"><a href="https://hackthebox.eu/home/users/profile/400084" target="_blank" rel="noopener noreferrer"
        title="Hackthebox"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
    preserveAspectRatio="xMidYMid meet" viewBox="0 0 64 64" fill="currentColor" stroke="currentColor">
    <g>
        <path
            d="M4.63 15.53L4.63 31.85L4.63 48.27L18.36 56.14L32 64L45.74 56.14L59.37 48.17L59.37 31.95L59.37 15.63C51.31 10.97 46.83 8.38 45.93 7.86C38.57 3.58 32.3 0 32 0C31.7 0 25.43 3.48 18.07 7.76C16.27 8.8 11.79 11.39 4.63 15.53ZM49.62 17.32C49.12 18.71 33.79 27.77 32 27.77C30.21 27.77 14.88 18.71 14.38 17.32C14.18 16.62 30.01 6.27 31.8 5.97C31.9 5.97 36.08 8.36 40.96 11.15C45.93 14.03 49.82 16.82 49.62 17.32ZM29.01 33.84C29.01 40.11 29.01 43.6 29.01 44.29C29.01 51.36 28.62 54.74 27.92 54.74C27.32 54.74 23.04 52.65 18.46 50.07C17.91 49.75 15.12 48.15 10.1 45.29L10.1 34.04L10.1 22.79C13.57 24.7 15.49 25.77 15.88 25.98C18.96 27.77 23.24 30.26 25.33 31.55C25.82 31.86 27.05 32.62 29.01 33.84ZM36.08 54.74C35.28 54.74 34.99 51.66 35.19 44.09C35.2 43.38 35.3 39.83 35.48 33.44L44.44 28.17L53.4 22.99C53.7 29.08 53.86 32.47 53.9 33.14C54.2 38.72 54.3 43.7 54.1 44.29C53.8 45.49 37.77 54.74 36.08 54.74Z">
        </path>
    </g>
</svg></a><a href="https://github.com/TableMagnet" target="_blank" rel="noopener noreferrer"
        title="Github"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg></a><a href="https://twitter.com/TableMagnet" target="_blank" rel="noopener noreferrer"
        title="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z">
    </path>
</svg></a><a href="mailto:human@tablemagnet.com" target="_blank" rel="noopener noreferrer"
        title="Email"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
    <polyline points="22,6 12,13 2,6"></polyline>
</svg></a></div></footer>
</article>
<article class="post-entry">
  <header class="entry-header">
    <h2>
      Simplifying Assembly
    </h2>
  </header>
  <section class="entry-content">
    <p>During some reversing practice I came across a section of assembly which caught my attention because of Ghidra‚Äôs decompilaion. Ghidra has decompiled this section of assembly into a single line with multiple bitwise operations which did not appear to be a reasonably representation.
I thought this might be a good opportunity to dissect some intriguing logic. This is Ghidra‚Äôs disassembly.
00402fb8 push ESI 00402fb9 call __scrt_is_ucrt_dll_in_use 00402fbe test EAX,EAX 00402fc0 jz LAB_00402fe2 00402fc2 mov EAX,FS:[0x18] 00402fc8 mov ESI,DAT_00408448 00402fcd mov EDX,[EAX &#43; 0x4] 00402fd0 jmp LAB_00402fd6 00402fd2 cmp EDX,EAX 00402fd4 jz LAB_00402fe6 00402fd6 xor EAX,EAX 00402fd8 mov ECX,EDX 00402fda lock 00402fdb cmpxchg [ESI],ECX 00402fde test EAX,EAX 00402fe0 jnz LAB_00402fd6 00402fe2 xor al,al 00402fe4 pop ESI 00402fe5 ret 00402fe6 mov al,0x1 00402fe8 pop ESI 00402fe9 ret The code first calls a function and tests the result returned in EAX....</p>
  </section>
  <footer class="entry-footer">
    <time>04 October 2020</time>
  </footer>
  <a class="entry-link" aria-label="post link to Simplifying Assembly" href="https://tablemagnet.com/posts/2020-10-04-simplifying-assembly.html"></a>
</article>

    </main><footer class="footer">
    <span>&copy; 2020 <a href="https://tablemagnet.com/">TableMagnet</a></span>
    <span>&middot;</span>
    <span>Powered by <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">HugoÔ∏èÔ∏è</a>Ô∏è</span>
    <span>&middot;</span>
    <span>ThemeÔ∏è <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top">
    <button class="top-link" id="top-link" type="button">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6">
            <path d="M12 6H0l6-6z" /></svg>
    </button>
</a>
<script>
    window.onload = function () {
        if (localStorage.getItem("menu-scroll-position")) {
            document.getElementById('menu').scrollLeft = localStorage.getItem("menu-scroll-position");
        }
    }
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();

            document.querySelector(this.getAttribute("href")).scrollIntoView({
                behavior: "smooth"
            });
        });
    });
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };
    function menu_on_scroll() {
        localStorage.setItem("menu-scroll-position", document.getElementById('menu').scrollLeft);
    }
</script>
</body>

</html>